<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>Google + Kakao Map Sync</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
  }
  #container {
    display: flex;
    width: 100%;
    height: 100%;
  }
  #googleMap, #kakaoMap {
    flex: 1;
    height: 100%;
  }

  /* 버튼 스타일 */
  #kakaoControls {
    position: absolute;
    top: 10px;
    left: 55%;
    transform: translateX(-50%);
    z-index: 9999;
    display: flex;
    gap: 8px;
  }
  .btn {
    padding: 6px 12px;
    background: #fff;
    border: 1px solid #888;
    cursor: pointer;
    border-radius: 4px;
    font-size: 14px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.3);
  }
</style>
</head>

<body>

<div id="container">
  <div id="googleMap"></div>
  <div id="kakaoMap"></div>
</div>

<!-- 카카오맵 지도/스카이뷰 버튼 -->
<div id="kakaoControls">
  <div class="btn" onclick="setKakaoMapType('roadmap')">지도</div>
  <div class="btn" onclick="setKakaoMapType('skyview')">스카이뷰</div>
</div>

<!-- Kakao Maps API -->
<script src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=YOUR_KAKAO_KEY"></script>

<!-- Google Maps API -->
<script async defer src="https://maps.googleapis.com/maps/api/js?key=YOUR_GOOGLE_KEY"></script>

<script>
/* ===================================================
   1️⃣ 축척 매핑 테이블 (Google Zoom ↔ Kakao Level)
   =================================================== */
const zoomToLevel = {
    19: 1, 18: 2, 17: 3, 16: 4, 15: 5,
    14: 6, 13: 7, 12: 8, 11: 9, 10: 10
};

const levelToZoom = {
    1: 19, 2: 18, 3: 17, 4: 16, 5: 15,
    6: 14, 7: 13, 8: 12, 9: 11, 10: 10
};

let googleMap, kakaoMap;
let isSyncing = false;

/* ======================================
   2️⃣ 지도 초기화
   ====================================== */
function initMaps() {
    // Google 지도
    googleMap = new google.maps.Map(document.getElementById("googleMap"), {
        center: { lat: 37.5665, lng: 126.9780 },
        zoom: 15
    });

    // Kakao 지도
    kakaoMap = new kakao.maps.Map(document.getElementById("kakaoMap"), {
        center: new kakao.maps.LatLng(37.5665, 126.9780),
        level: zoomToLevel[15]
    });

    /* ======================================
       3️⃣ Google → Kakao 동기화
       ====================================== */
    googleMap.addListener("idle", function () {
        if (isSyncing) return;
        isSyncing = true;

        const center = googleMap.getCenter();
        const zoom = googleMap.getZoom();
        const level = zoomToLevel[zoom] || 5;

        kakaoMap.setCenter(new kakao.maps.LatLng(center.lat(), center.lng()));
        kakaoMap.setLevel(level);

        isSyncing = false;
    });

    /* ======================================
       4️⃣ Kakao → Google 동기화
       ====================================== */
    kakao.maps.event.addListener(kakaoMap, 'idle', function () {
        if (isSyncing) return;
        isSyncing = true;

        const center = kakaoMap.getCenter();
        const level = kakaoMap.getLevel();
        const zoom = levelToZoom[level] || 15;

        googleMap.setCenter({ lat: center.getLat(), lng: center.getLng() });
        googleMap.setZoom(zoom);

        isSyncing = false;
    });
}

/* ======================================
   5️⃣ Kakao 지도 타입 변경 버튼
   ====================================== */
function setKakaoMapType(type) {
    if (type === "roadmap") {
        kakaoMap.setMapTypeId(kakao.maps.MapTypeId.ROADMAP);
    } else if (type === "skyview") {
        kakaoMap.setMapTypeId(kakao.maps.MapTypeId.HYBRID);
    }
}

/* ======================================
   6️⃣ 두 API 준비 완료될 때까지 기다림
   ====================================== */
function waitUntilReady() {
    if (typeof kakao !== "undefined" &&
        typeof kakao.maps !== "undefined" &&
        typeof google !== "undefined" &&
        typeof google.maps !== "undefined") {
        initMaps();
    } else {
        setTimeout(waitUntilReady, 150);
    }
}

waitUntilReady();
</script>
</body>
</html>


